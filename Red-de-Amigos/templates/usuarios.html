{% extends 'base.html' %}
{% block title %}Usuarios - Entrelazados{% endblock %}

{% block content %}
<div class="usuarios-container">
    <div class="usuarios-header">
        <div class="usuarios-header-title">
            <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo" style="height:38px;vertical-align:middle;margin-right:10px;">
            Usuarios de Entrelazados
        </div>
        <!-- Puedes agregar aquí un botón para agregar usuario si lo deseas -->
    </div>

    <!-- Opciones de búsqueda y filtros -->
    <form method="get" class="usuarios-busqueda">
        <input type="text" name="busqueda" placeholder="Buscar usuario..." value="{{ request.args.get('busqueda', '') }}">
        <select name="filtro">
            <option value="">Todos</option>
            <option value="amigos" {% if request.args.get('filtro') == 'amigos' %}selected{% endif %}>Solo amigos</option>
            <option value="noamigos" {% if request.args.get('filtro') == 'noamigos' %}selected{% endif %}>No amigos</option>
        </select>
        <button type="submit" class="btn btn-primary">Buscar</button>
    </form>

    <!-- Sección de recomendaciones -->
    <div style="margin-bottom:32px;">
        <h3>Recomendaciones de amistad</h3>
        <div class="usuarios-lista">
            {% for recomendado in recomendaciones %}
            <div class="usuario-card">
                <img src="{{ url_for('static', filename='avatars/' ~ (recomendado.avatar if recomendado.avatar else 'default.png')) }}" alt="Avatar">
                <div style="font-weight:bold;color:#235390;">{{ recomendado.username }}</div>
                <div style="font-size:0.95rem;color:#666;">{{ recomendado.datos_personales.nombre }}</div>
                <a href="{{ url_for('ver_perfil', username=recomendado.username) }}" class="btn btn-outline-secondary">Ver perfil</a>
                <a href="{{ url_for('enviar_solicitud', username=recomendado.username) }}" class="btn btn-primary">Agregar amigo</a>
            </div>
            {% else %}
            <div style="color:#888;">Sin recomendaciones por ahora.</div>
            {% endfor %}
        </div>
    </div>

    <!-- Lista de todos los usuarios -->
    <div>
        <div class="usuarios-titulo">Todos los usuarios</div>
        <div class="usuarios-lista">
            {% for usuario in usuarios %}
            <div class="usuario-card">
                <img src="{{ url_for('static', filename='avatars/' ~ (usuario.avatar if usuario.avatar else 'default.png')) }}" alt="Avatar">
                <div style="font-weight:bold;color:#235390;">{{ usuario.username }}</div>
                <div style="font-size:0.95rem;color:#666;">{{ usuario.datos_personales.nombre }}</div>
                <a href="{{ url_for('ver_perfil', username=usuario.username) }}" class="btn btn-outline-secondary">Ver perfil</a>
                {% if usuario.username not in amigos and usuario.username != session['username'] %}
                <a href="{{ url_for('enviar_solicitud', username=usuario.username) }}" class="btn btn-primary">Agregar amigo</a>
                {% endif %}
            </div>
            {% else %}
            <div style="color:#888;">No hay usuarios para mostrar.</div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}

